<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Insert Custom Benchmarks &mdash; JADE v2.0.0 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Modify documentation" href="docmodify.html" />
    <link rel="prev" title="Troubleshooting" href="../usage/troubleshooting.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> JADE
            <img src="../_static/Jade_white.jpg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">JADE User Guide:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../nutshell.html">JADE in a nutshell</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/folders.html">Folder Structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/menu.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/benchmarks.html">Default Benchmarks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/postprocessing.html">Post-Processing Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/utilities.html">Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/tipstricks.html">Tips &amp; Tricks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/troubleshooting.html">Troubleshooting</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">JADE Developer Guide:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Insert Custom Benchmarks</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#insert-custom-computational-benchmark">Insert Custom Computational Benchmark</a></li>
<li class="toctree-l2"><a class="reference internal" href="#insert-custom-experimental-benchmark">Insert Custom Experimental Benchmark</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#call-the-right-output-class">Call the right Output class</a></li>
<li class="toctree-l3"><a class="reference internal" href="#additional-actions-for-multi-run-benchmarks">Additional actions for multi-run benchmarks</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="docmodify.html">Modify documentation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">JADE API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/general.html">General OOP scheme</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/initobjects.html">JADE Session</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/inputgeneration.html">Input Generation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/postprocessing.html">Post-Processing</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">More on JADE:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../testing/testing.html">JADE Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../LICENSE.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributors.html">Contributors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../publications.html">List of Publications and Contributions</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">JADE</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Insert Custom Benchmarks</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/dev/insertbenchmarks.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="insert-custom-benchmarks">
<h1>Insert Custom Benchmarks<a class="headerlink" href="#insert-custom-benchmarks" title="Permalink to this headline"></a></h1>
<p>This section of the guide describes how to add custom benchmarks to the JADE suite. The procedures
necessary to implement new computational and experimental benchmarks are different and are
described respectively in <a class="reference internal" href="#customcompbench"><span class="std std-ref">Insert Custom Computational Benchmark</span></a> and <a class="reference internal" href="#customexpbench"><span class="std std-ref">Insert Custom Experimental Benchmark</span></a>.</p>
<div class="section" id="insert-custom-computational-benchmark">
<span id="customcompbench"></span><h2>Insert Custom Computational Benchmark<a class="headerlink" href="#insert-custom-computational-benchmark" title="Permalink to this headline"></a></h2>
<p>Implementing a new computational benchmark is relatively easy and, theoretically, no additional
code is required. The procedure is composed by the following steps:</p>
<ol class="arabic simple">
<li><p>Once the benchmark input has been finalized, save it as <code class="docutils literal notranslate"><span class="pre">&lt;JADE_root&gt;\Benchmark</span> <span class="pre">inputs\&lt;name&gt;.i</span></code>.</p></li>
<li><p>Add the benchmark to the main configuration file in the computational sheet. See <a class="reference internal" href="../usage/configuration.html#compsheet"><span class="std std-ref">Computational benchmarks</span></a>
for additional information on this.</p></li>
<li><p>[OPTIONAL] if external weight windows (WW) are used, the WW file must be named <em>wwinp</em> and inserted in
<code class="docutils literal notranslate"><span class="pre">&lt;JADE_root&gt;\Benchmark</span> <span class="pre">inputs\VRT\&lt;name&gt;\</span></code>.</p></li>
<li><p>Create a custom post-processing configuration file as described in <a class="reference internal" href="../usage/configuration.html#ppconf"><span class="std std-ref">Benchmark post-processing configuration</span></a> and save it in
<code class="docutils literal notranslate"><span class="pre">&lt;JADE_root&gt;\Configuration\Benchmarks</span> <span class="pre">Configuration\&lt;name&gt;.xlsx</span></code></p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The benchmark input should not contain any STOP paramaters or NPS card (this is regulated by the
main configuration file).</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is recommended to provide a comment card (FC) for each tally. These comments are considered the
extended tally names and are used during post-processing.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>benchmark input file name cannot end with ‘o’ or ‘m’.</p>
</div>
</div>
<div class="section" id="insert-custom-experimental-benchmark">
<span id="customexpbench"></span><h2>Insert Custom Experimental Benchmark<a class="headerlink" href="#insert-custom-experimental-benchmark" title="Permalink to this headline"></a></h2>
<p>Inserting a custom experimental benchmark is slightly more complex, but a significant higher order
of customization is guaranteed.
Steps 1) and 2) of the computational benchmarks procedure still need to be followed but then some
additional coding needs to be performed, specifically, a new child of the <a class="reference internal" href="../api/postprocessing.html#expoutputclass"><span class="std std-ref">ExperimentalOutput</span></a>
class needs to be defined inside <code class="docutils literal notranslate"><span class="pre">&lt;JADE_root&gt;\Code\expoutput.py</span></code>.
In order to do that, at least the three abstract methods <code class="docutils literal notranslate"><span class="pre">_processMCNPdata()</span></code>, <code class="docutils literal notranslate"><span class="pre">_pp_excel_comparison()</span></code>
and <code class="docutils literal notranslate"><span class="pre">_build_atlas()</span></code> need to be implemented in the new class.
Once this has been done, a few other adjustments need to be done to the code.</p>
<div class="section" id="call-the-right-output-class">
<h3>Call the right Output class<a class="headerlink" href="#call-the-right-output-class" title="Permalink to this headline"></a></h3>
<p>In <code class="docutils literal notranslate"><span class="pre">&lt;JADE_root&gt;\Code\postprocess.py</span></code>, the function <code class="docutils literal notranslate"><span class="pre">_get_output()</span></code> controls the creation of the
benchmark object during post-processing depending on the benchmark. Here an <em>elif</em> statement needs
to be added to ensure that the newly created custom class is called when generating the output for
the custom added experimental benchmark. Here is an example of how the FNG benchmark was added:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">...</span>

<span class="k">elif</span> <span class="n">testname</span> <span class="o">==</span> <span class="s1">&#39;FNG&#39;</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">action</span> <span class="o">==</span> <span class="s1">&#39;compare&#39;</span><span class="p">:</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">expo</span><span class="o">.</span><span class="n">FNGOutput</span><span class="p">(</span><span class="n">lib</span><span class="p">,</span> <span class="n">testname</span><span class="p">,</span> <span class="n">session</span><span class="p">,</span> <span class="n">multiplerun</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">action</span> <span class="o">==</span> <span class="s1">&#39;pp&#39;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">exp_pp_message</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span>

<span class="o">...</span>
</pre></div>
</div>
<p>The user should just substitute <code class="docutils literal notranslate"><span class="pre">FNG</span></code> with the name of the benchmark input and <code class="docutils literal notranslate"><span class="pre">FNGOutput</span></code> with
the newly created class. Attention should be paid also to the <code class="docutils literal notranslate"><span class="pre">multiplerun</span></code> keyword, set True if
the benchmark is actually composed by more than one input (i.e. multiple MCNP/D1S runs).</p>
</div>
<div class="section" id="additional-actions-for-multi-run-benchmarks">
<h3>Additional actions for multi-run benchmarks<a class="headerlink" href="#additional-actions-for-multi-run-benchmarks" title="Permalink to this headline"></a></h3>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>these next actions need to be performed <strong>only</strong> if the benchmark is composed by more than one input.</p>
</div>
<p>In <code class="docutils literal notranslate"><span class="pre">&lt;JADE_root&gt;\Code\status.py</span></code> the name of the benchmark input needs to be added to the MULTI_TEST</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">MULTI_TEST</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Sphere&#39;</span><span class="p">,</span> <span class="s1">&#39;Oktavian&#39;</span><span class="p">,</span> <span class="s1">&#39;SphereSDDR&#39;</span><span class="p">,</span> <span class="s1">&#39;FNG&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>In <code class="docutils literal notranslate"><span class="pre">&lt;JADE_root&gt;\Code\computational.py</span></code> the function <code class="docutils literal notranslate"><span class="pre">executeBenchmarksRoutines</span></code> is responsible for
the generation and run of the benchmarks during a JADE session. The modification here is to be performed
in the part that is responsible for choosing the Test object to be used depending on the benchmark.
Here is the code snippet of interest:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">...</span>

<span class="c1"># Handle special cases</span>
<span class="k">if</span> <span class="n">testname</span> <span class="o">==</span> <span class="s1">&#39;Sphere Leakage Test&#39;</span><span class="p">:</span>
    <span class="n">test</span> <span class="o">=</span> <span class="n">testrun</span><span class="o">.</span><span class="n">SphereTest</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>

<span class="k">elif</span> <span class="n">testname</span> <span class="o">==</span> <span class="s1">&#39;Sphere SDDR&#39;</span><span class="p">:</span>
    <span class="n">test</span> <span class="o">=</span> <span class="n">testrun</span><span class="o">.</span><span class="n">SphereTestSDDR</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>

<span class="k">elif</span> <span class="n">fname</span> <span class="o">==</span> <span class="s1">&#39;Oktavian&#39;</span><span class="p">:</span>
    <span class="n">test</span> <span class="o">=</span> <span class="n">testrun</span><span class="o">.</span><span class="n">MultipleTest</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>

<span class="k">elif</span> <span class="n">fname</span> <span class="o">==</span> <span class="s1">&#39;FNG&#39;</span><span class="p">:</span>
    <span class="n">test</span> <span class="o">=</span> <span class="n">testrun</span><span class="o">.</span><span class="n">MultipleTest</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">TestOb</span><span class="o">=</span><span class="n">testrun</span><span class="o">.</span><span class="n">FNGTest</span><span class="p">)</span>

<span class="k">else</span><span class="p">:</span>
    <span class="n">test</span> <span class="o">=</span> <span class="n">testrun</span><span class="o">.</span><span class="n">Test</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>

<span class="o">...</span>
</pre></div>
</div>
<p>The default option is to simply create a <code class="docutils literal notranslate"><span class="pre">Test</span></code> object. Clearly, if a children was defined
specifically for the new experimental benchmark, an option would need to be added here.
If the benchmark is a multirun one, an additional <em>elif</em> statement needs to be added similarly
to what has been done for the FNG benchmark.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>see also <a class="reference internal" href="../api/inputgeneration.html#testrunmodule"><span class="std std-ref">testrun module</span></a> for a better description of the Test object and his children</p>
</div>
</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../usage/troubleshooting.html" class="btn btn-neutral float-left" title="Troubleshooting" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="docmodify.html" class="btn btn-neutral float-right" title="Modify documentation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Davide Laghi.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>